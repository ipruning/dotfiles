Think hard and review this code for security vulnerabilities
